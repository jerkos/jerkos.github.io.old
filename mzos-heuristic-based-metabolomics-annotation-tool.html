<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>mzOS, heuristiques pour l’annotation en métabolomique - jerkos</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="mzOS, heuristiques pour l’annotation en métabolomique"/>
            <meta property="og:url" content="/mzos-heuristic-based-metabolomics-annotation-tool.html"/>
            <meta property="og:description" content="Ayant passer le plus clair de mon temps (au boulot n’est ce pas) à développer des outils pour traiter des données de spectrométrie de masse pour la mébolomique et protéomique, il me fallait contribuer très humblement et succintement à ce petit monde et notamment à celui de la métabolomique ..."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="/theme/css/bootstrap.united.min.css" type="text/css"/>
    <link href="/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="/theme/css/pygments/native.css" rel="stylesheet">
        <link href="/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/css/style.css" type="text/css"/>
        <link href="/images/static/custom.css" rel="stylesheet">


</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="/" class="navbar-brand">
jerkos            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="/pages/about-me.html">
                             About&nbsp;me
                          </a></li>
                        <li class="active">
                            <a href="/category/review.html">Review</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="/mzos-heuristic-based-metabolomics-annotation-tool.html"
                       rel="bookmark"
                       title="Permalink to mzOS, heuristiques pour l’annotation en métabolomique">
                        mzOS, heuristiques pour l&#8217;annotation en&nbsp;métabolomique
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-03-26T00:00:00"> jeu. 26 mars 2015</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="/tag/python.html">python</a>
        /
	<a href="/tag/data-mining.html">data-mining</a>
        /
	<a href="/tag/mass-spectrometry.html">mass-spectrometry</a>
        /
	<a href="/tag/metabolomics.html">metabolomics</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p><strong>Ayant passer le plus clair de mon temps (au boulot n&#8217;est ce pas) à développer des outils pour traiter des données de spectrométrie de masse pour la mébolomique et protéomique, il me fallait contribuer très humblement et succintement à ce petit monde et notamment à celui de la&nbsp;métabolomique.</strong></p>
<hr />
<h3>Introduction</h3>
<p>En général, le traitement <span class="caps">MS</span> en métabolomique (en non ciblé) se découpe en plusieurs&nbsp;phases:</p>
<ul>
<li>une première pour extraire les signaux des cartes <span class="caps">LC</span>/<span class="caps">MS</span></li>
<li>une deuxième pour aligner et donc ensuite matcher les signaux de plusieurs cartes (ceux correspondant à la même&nbsp;espèce)</li>
<li>enfin une troisième pour assigner une espèce connue (issue de base de données) ou non à un maximum de signaux. On note ici, qu&#8217;il est toujours de faire un vérification&nbsp;experimentale</li>
</ul>
<p>Je me suis attardé sur la troisième phase car c&#8217;est à mon avis la plus critique, en même temps la plus abordable d&#8217;un point de vie algorithmique (pas besoin de traitement de signal, mathématiques -wavelet-&nbsp;etc&#8230;).</p>
<h3>De quoi s&#8217;agit-il&nbsp;?</h3>
<p>Comme l&#8217;annonce le titre, mzOS est un petit package python permettant d&#8217;annoter, <em>ie de detecter les adduits et isotopes</em>, abondant dans les données de spectrométrie de masse, à partir d&#8217;un simple tableau de <em>features</em>. L&#8217;idée est de le faire tourner après des outils comme <em><span class="caps">XCMS</span></em>, référence dans en la matière ou <em>matra</em> permettant de faire de la détection de features sur un jeu de données (preuve de concept), ou encore le binding python de <em>OpenMS</em>&nbsp;pyopenms. </p>
<p>Plusieurs packages R ont déjà été implémentés, notamment un des plus connus <span class="caps">CAMERA</span> et plus récemment, des outils visant à assigner à chaque possibilité d&#8217;annotation pour un signal une valeur de probabilité (Probmetab), basés sur des méthodes bayésiennes. Cette valeur de probabilité peut prendre en compte le réseau metabolique de l&#8217;espèce, les ratios entres les isotopes, les temps de rétention prédits et bien d&#8217;autres métriques auxquelles nous n&#8217;avons pas encore pensé j&#8217;imagine. Ces outils sont évidemment intéressant lorque le nombre d&#8217;annotation possible est supérieur à 1. Sachant que les analyseurs de masse sont de plus en plus performant, on s&#8217;acheminera vers la seule annotation possible en combinaison avec une base de données sur les temps de rétention&nbsp;maison.</p>
<h4><strong>Pourquoi python&nbsp;?</strong></h4>
<p>Python est un langage simple et lisible comme tout le monde le sait, et possède de nombreux packages pour la science ce qui en fait clairement sa force. On pense notamment à numpy, scipy, scikit-learn. Ainsi, même si c&#8217;est au départ c&#8217;est un langage clairement lent, tout cette <em>stack</em> permet d&#8217;en faire un langage de programmation majeur dans le monde de la sciences aux cotés de R&nbsp;notamment.</p>
<h3>Annotations des isotopes et des&nbsp;adduits</h3>
<p>La procédure d&#8217;annotation des signaux ressemble fortement dans une premier temps à l&#8217;algorithme de <span class="caps">CAMERA</span>. Il diffère principalement par la methode de clustering basé sur le temps de rétention (<em><span class="caps">DB</span>-<span class="caps">SCAN</span></em>) pour regrouper les signaux, puis un clustering hiérarchique basé sur les corrélations inter-échantillons et sur la forme des progiles d&#8217;élution. L&#8217;algorithme utilise ensuite des heuristiques relativement complexes pour lever des ambiguités lors de l&#8217;attribution des isotopes et&nbsp;adduits.</p>
<div class="highlight"><pre><span class="cp">#Annotation determining isotopes and adducts by default</span>
<span class="n">peakels_annotator</span> <span class="o">=</span> <span class="n">PeakelsAnnotator</span><span class="p">(</span><span class="n">peakels</span><span class="p">,</span> <span class="n">exp_settings</span><span class="p">)</span>
<span class="n">monoisotopic_peakels</span> <span class="o">=</span> <span class="n">peakels_annotator</span><span class="p">.</span><span class="n">annotate</span><span class="p">()</span>

<span class="n">db_search</span> <span class="o">=</span> <span class="n">DatabaseSearch</span><span class="p">(</span><span class="s">&quot;hmdb&quot;</span><span class="p">,</span> <span class="n">exp_settings</span><span class="p">)</span>
<span class="cp">#search for a delta of 1 proton, could be anything else</span>
<span class="cp">#cumulation is allowed: [&quot;H1&quot;, &quot;H2&quot;]</span>
<span class="n">adducts_l</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;H1&quot;</span><span class="p">]</span>  
<span class="n">metabolites</span> <span class="o">=</span> <span class="n">db_search</span><span class="p">.</span><span class="n">assign_formula</span><span class="p">(</span><span class="n">peakels</span><span class="p">,</span> <span class="n">adducts_l</span><span class="p">,</span> <span class="n">exp_settings</span><span class="p">.</span><span class="n">mz_tol_ppm</span><span class="p">)</span>

<span class="cp">#Compute score 1 based on isotopic ratios</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">StatsModel</span><span class="p">(</span><span class="n">peakels</span><span class="p">,</span> <span class="n">exp_settings</span><span class="p">.</span><span class="n">mz_tol_ppm</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">calculate_score</span><span class="p">()</span>

<span class="cp">#Compute metabolite probabilities</span>
<span class="n">bi</span> <span class="o">=</span> <span class="n">BayesianInferer</span><span class="p">(</span><span class="n">peakels</span><span class="p">,</span> <span class="n">exp_settings</span><span class="p">)</span>
<span class="n">bi</span><span class="p">.</span><span class="n">infer_assignment_probabilities</span><span class="p">()</span>

<span class="cp">#Exporting results...</span>
<span class="n">exporter</span> <span class="o">=</span> <span class="n">ResultsExporter</span><span class="p">(</span><span class="n">arguments</span><span class="p">.</span><span class="n">output</span><span class="p">,</span> <span class="n">peakels</span><span class="p">)</span>
<span class="n">exporter</span><span class="p">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>


<h3>Database&nbsp;annotation</h3>
<p>L&#8217;ensemble des signaux est recherché dans plusieurs bases de données (<span class="caps">HMDB</span>, <span class="caps">LMSD</span>, <span class="caps">KEGG</span> pour le moment) en spécifiant la charge et l&#8217;adduit. Par exemple, on peut lancer des recherches pour chaque métabolite avec une liste d&#8217;adduits (M+H, M+2H, M+Na pour un mode positif). En effet, après l&#8217;étape d&#8217;annotation, on est en mesure de dire si le signal est signal correspondant à une espèce (monoisotopique). Cependant, on préfère lancer la recherche en ayant aucun à priori par défault. L&#8217;utilisateur peut décider de prendre en compte cette&nbsp;information.</p>
<p>La recherche est très rapide puisque mzOS contient un base de données sqlite contenant l&#8217;ensemble des différentes&nbsp;bases.</p>
<p>Plusieurs scores sont ensuite&nbsp;calculés:</p>
<ul>
<li>un correspondant à la différence des rapports isotopiques entre un massif observé et massif&nbsp;théorique</li>
<li>un second prenant en compte le réseau métabolique de l&#8217;espèce (sorte de gap filler), inférant des probabilités (inférence&nbsp;bayésienne).</li>
</ul>
<h2>Conclusion</h2>
<p>Vous pourrez trouver le code sur Github, en cliquant judicieusement dans la sidebar de&nbsp;droite.</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
        <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
        <a class="addthis_button_tweet"></a>
        <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=5513e13c162ecf83"></script>
    <!-- AddThis Button END -->
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jerkos'; // required: replace example with your forum shortname
            var disqus_identifier = 'mzos-heuristic-based-metabolomics-annotation-tool';
            var disqus_url = '/mzos-heuristic-based-metabolomics-annotation-tool.html';
            var disqus_config = function () {
                this.language = "fr";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item"><a href="#"><i
                            class="fa fa-twitter-square fa-lg"></i> twitter
                    </a></li>
                    <li class="list-group-item"><a href="#"><i
                            class="fa fa-linkedin-square fa-lg"></i> linkedin
                    </a></li>
                    <li class="list-group-item"><a href="#"><i
                            class="fa fa-github-square fa-lg"></i> github
                    </a></li>
                  </ul>
                </li>



                <li class="list-group-item"><a href="/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group" id="tags">
                        <li class="list-group-item tag-1">
                            <a href="/tag/mass-spectrometry.html">
                                mass-spectrometry
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="/tag/metabolomics.html">
                                metabolomics
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/proteomics.html">
                                proteomics
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/hello.html">
                                hello
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/file-format.html">
                                file format
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/python.html">
                                python
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/data-mining.html">
                                data-mining
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/mzml.html">
                                mzML
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="/tag/c.html">
                                c++
                            </a>
                        </li>
                    </ul>
                </li>    

    <li class="list-group-item"><h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
    </li>
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://omics-services.com" target="_blank">
                Omics Services
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 jerkos
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://code.jquery.com/jquery.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="/theme/js/respond.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            if (!window.jXHR) {
                var jxhr = document.createElement('script');
                jxhr.type = 'text/javascript';
                jxhr.src = '/theme/js/jXHR.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(jxhr, s);
            }

            github.showRepos({
                user: 'jerkos',
                count: 5,
                skip_forks: false,
                target: '#gh_repos'
            });
        });
    </script>
    <script src="/theme/js/github.js" type="text/javascript"></script>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jerkos'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
</body>
</html>